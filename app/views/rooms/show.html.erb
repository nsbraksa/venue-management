<h3>Check availability of <%= @room.name %>:</h3>

<%= form_tag room_availability_user_room_url(current_user, @room), method: 'post', url: {action: "room_availability"}, html: {class: "authform"} do %>
  <div class="field">
    <%= label_tag :start_date %>
    <%= select_datetime DateTime.current, prefix: :start_check %>
  </div>

  <div class="field">
    <%= label_tag :end_date %>
    <%= select_datetime DateTime.current, prefix: :end_check %>
  </div>

  <%= submit_tag "Check avalability", class: "btn btn-success" %>
<% end %>

<br><br>

<h3>Room: <%= @room.name %></h3>
<div class="panel panel-default">
  <div class="panel-heading"><h4>Bookings:</h4></div>
    <% if @room.bookings.empty? %>
      <p>
        No bookings for this room, try making one.
      </p>
    <% else %>
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Start date</th>
            <th>End date</th>
            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% id = 0 %>
          <% @room.bookings.all.each do |booking| %>
            <tr>
              <% id = id + 1 %>
              <td><%= id %></td>
              <td><%= booking.start_date %></td>
              <td><%= booking.end_date %></td>
              <td><%= link_to 'Show', booking_path(booking) %></td>
              <td><%= link_to 'Destroy', booking, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>


<%= link_to 'New Booking', new_room_booking_path(@room), class: "btn btn-success" %>

<br><br>
<br><br>

<%= link_to 'Edit', edit_user_room_path(current_user, @room), class: "btn btn-success" %> |
<%= link_to 'Destroy', @room, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-success" %> |
<%= link_to 'Back', user_rooms_path(current_user), class: "btn btn-success" %>
